# ะะตัะฐะปัะฝะพะต ะพะฑัััะฝะตะฝะธะต ัะฐะฑะพัั ะบะพะดะฐ

## ๐ ะะฑัะธะน ะฟะพัะพะบ ะฒัะฟะพะปะฝะตะฝะธั (Flow)

### 1. ะะฝะธัะธะฐะปะธะทะฐัะธั (main.cpp โ Restaurant)

```
main()
  โ
Restaurant::Restaurant()
  โโ BurgerInventory(10) - ัะพะทะดะฐะตั ะธะฝะฒะตะฝัะฐัั ั 10 ะฑััะณะตัะฐะผะธ ะบะฐะถะดะพะณะพ ัะธะฟะฐ
  โโ TableManager() - ัะพะทะดะฐะตั 5 ััะพะปะธะบะพะฒ
  โโ Manager(inventory, 10) - ัะพะทะดะฐะตั ะผะตะฝะตะดะถะตัะฐ ั ะบะพะปะธัะตััะฒะพะผ ะฟะพะฟะพะปะฝะตะฝะธั
  โโ Customer[N] - ัะพะทะดะฐะตั N ะฟะพะบัะฟะฐัะตะปะตะน (ะฟะพ ัะผะพะปัะฐะฝะธั 8)
  โโ setupManagerCallback() - ะฝะฐัััะฐะธะฒะฐะตั callback ะดะปั ัะฒะตะดะพะผะปะตะฝะธั ะผะตะฝะตะดะถะตัะฐ
```

### 2. ะะฐะฟััะบ ะฟะพัะพะบะพะฒ (Restaurant::start())

```
Restaurant::start()
  โ
  โโ Manager::start() 
  โ   โโ ะกะพะทะดะฐะตั ะฟะพัะพะบ ะผะตะฝะตะดะถะตัะฐ โ managerLoop() [ะะะะะะะข ะทะฐะฟัะพัั]
  โ
  โโ Customer[i]::start() ะดะปั ะบะฐะถะดะพะณะพ ะฟะพะบัะฟะฐัะตะปั
      โโ ะกะพะทะดะฐะตั ะฟะพัะพะบ ะฟะพะบัะฟะฐัะตะปั โ customerLoop() [ะะะขะะะะ ัะฐะฑะพัะฐะตั]
```

### 3. ะัะฝะพะฒะฝะพะน ัะธะบะป ัะฐะฑะพัั (ะฟะฐัะฐะปะปะตะปัะฝะพ ะฒัะฟะพะปะฝััััั ะฒัะต ะฟะพัะพะบะธ)

#### ะะพัะพะบ ะฟะพะบัะฟะฐัะตะปั (Customer::customerLoop)

```
ะะะขะะ ะะะะฃะะะขะะะฏ (ะฑะตัะบะพะฝะตัะฝัะน ัะธะบะป):
  โ
  1. chooseBurgerType() - ัะปััะฐะนะฝัะน ะฒัะฑะพั ัะธะฟะฐ ะฑััะณะตัะฐ (0-2)
  โ
  2. inventory_.tryBuyBurger(burgerType)
     โโ ะะปะพะบะธััะตั mutex_ ะธะฝะฒะตะฝัะฐัั
     โโ ะัะพะฒะตััะตั stock_[burgerType] > 0
     โโ ะัะปะธ ะตััั: ัะผะตะฝััะฐะตั stock_[burgerType]--
     โโ ะัะปะธ stock ััะฐะป 0: ะฒัะทัะฒะฐะตั notifyOutOfStock() โ callback โ ะผะตะฝะตะดะถะตั
     โโ ะะฐะทะฑะปะพะบะธััะตั mutex_
  โ
  3ะฐ. ะัะปะธ ะบัะฟะธะป ััะฟะตัะฝะพ:
     โโ waitForTableAndEat()
         โโ tableManager_.reserveTable() 
         โ   โโ ะะปะพะบะธััะตั mutex_ ััะพะปะธะบะพะฒ
         โ   โโ ะัะปะธ availableTables_ == 0: ะะะะะะะฃะะขะกะฏ ะฝะฐ condition_variable
         โ   โโ ะะดะตั ะฟะพะบะฐ availableTables_ > 0 (ััะปะพะฒะฝะฐั ะฟะตัะตะผะตะฝะฝะฐั)
         โ   โโ ะะพะณะดะฐ ะฟัะพัะฝัะปัั: availableTables_--
         โ   โโ ะะฐะทะฑะปะพะบะธััะตั mutex_
         โโ ะกะฟะธั 1-5 ัะตะบัะฝะด (ะตัั)
         โโ tableManager_.releaseTable()
             โโ ะะปะพะบะธััะตั mutex_ ััะพะปะธะบะพะฒ
             โโ availableTables_++
             โโ notify_one() - ะฑัะดะธั ะพะดะฝะพะณะพ ะพะถะธะดะฐััะตะณะพ ะฟะพะบัะฟะฐัะตะปั
             โโ ะะฐะทะฑะปะพะบะธััะตั mutex_
  โ
  3ะฑ. ะัะปะธ ะฝะต ะบัะฟะธะป (ะฝะตั ะฒ ะฝะฐะปะธัะธะธ):
     โโ manager_.callForRestock(burgerType) - ะฒัะทัะฒะฐะตั ะผะตะฝะตะดะถะตัะฐ
     โโ ะกะฟะธั 500ะผั
     โโ continue (ะฟะพะฒัะพััะตั ะฟะพะฟััะบั)
  โ
  4. ะกะฟะธั 100ะผั ะฟะตัะตะด ัะปะตะดัััะธะผ ัะธะบะปะพะผ
  โ
  โ ะะพะฒัะพั (ะฟะพะบะฐ running_ == true)
```

#### ะะพัะพะบ ะผะตะฝะตะดะถะตัะฐ (Manager::managerLoop)

```
ะะะขะะ ะะะะะะะะะ (ะฑะตัะบะพะฝะตัะฝัะน ัะธะบะป):
  โ
  1. ะะปะพะบะธััะตั mutex_ ะผะตะฝะตะดะถะตัะฐ
  โ
  2. restockRequest_.wait(lock, ััะปะพะฒะธะต)
     โโ ะะะะะะะฃะะขะกะฏ ะฝะฐ condition_variable
     โโ ะะดะตั ะฟะพะบะฐ hasPendingRequest_ == true ะธะปะธ running_ == false
     โโ ะัะธ notify_one() ะพั ะฟะพะบัะฟะฐัะตะปั: ะฟัะพะฒะตััะตั ััะปะพะฒะธะต
     โโ ะัะปะธ ััะปะพะฒะธะต ะฒัะฟะพะปะฝะตะฝะพ: ะฟัะพะดะพะปะถะฐะตั
  โ
  3. ะัะปะธ hasPendingRequest_ == true:
     โโ ะกะพััะฐะฝัะตั pendingRestockType_
     โโ ะกะฑัะฐััะฒะฐะตั hasPendingRequest_ = false
     โโ ะะฐะทะฑะปะพะบะธััะตั mutex_
     โโ inventory_.restock(burgerType, quantity)
     โ   โโ ะะปะพะบะธััะตั mutex_ ะธะฝะฒะตะฝัะฐัั
     โ   โโ stock_[burgerType] += quantity
     โ   โโ ะะฐะทะฑะปะพะบะธััะตั mutex_
     โโ ะัะฒะพะดะธั ัะพะพะฑัะตะฝะธะต
  โ
  โ ะะพะฒัะพั (ะฟะพะบะฐ running_ == true)
```

## ๐ ะะพัะพะบะพะฒะฐั ะพะฑัะฐะฑะพัะบะฐ

### ะะฐัะฐะปะปะตะปัะฝัะต ะฟะพัะพะบะธ

ะ ัะธััะตะผะต ะพะดะฝะพะฒัะตะผะตะฝะฝะพ ัะฐะฑะพัะฐัั:

1. **ะะปะฐะฒะฝัะน ะฟะพัะพะบ (main)**
   - ะฃะฟัะฐะฒะปัะตั ะถะธะทะฝะตะฝะฝัะผ ัะธะบะปะพะผ
   - ะัะฒะพะดะธั ััะฐััั ะบะฐะถะดัะต 5 ัะตะบัะฝะด
   - ะััะฐะฝะฐะฒะปะธะฒะฐะตั ะฒัะต ะฟะพัะพะบะธ

2. **1 ะฟะพัะพะบ ะผะตะฝะตะดะถะตัะฐ (Manager)**
   - ะะฐััะธะฒะฝัะน ะฟะพัะพะบ (ัะฟะธั, ะฟะพะบะฐ ะฝะตั ะทะฐะฟัะพัะพะฒ)
   - ะัะพััะฟะฐะตััั ะฟะพ ัะฒะตะดะพะผะปะตะฝะธั ัะตัะตะท condition_variable

3. **N ะฟะพัะพะบะพะฒ ะฟะพะบัะฟะฐัะตะปะตะน (Customer)**
   - ะะบัะธะฒะฝัะต ะฟะพัะพะบะธ (ะฟะพััะพัะฝะฝะพ ัะฐะฑะพัะฐัั)
   - ะะฐะถะดัะน ะฟะพะบัะฟะฐัะตะปั ัะฐะฑะพัะฐะตั ะฝะตะทะฐะฒะธัะธะผะพ
   - ะัะต ะพะดะฝะพะฒัะตะผะตะฝะฝะพ ะผะพะณัั ะฟััะฐัััั ะบัะฟะธัั ะฑััะณะตั, ะทะฐะฝััั ััะพะปะธะบ

### ะะทะฐะธะผะพะดะตะนััะฒะธะต ะฟะพัะพะบะพะฒ

```
โโโโโโโโโโโโโโโ
โ  ะะพะบัะฟะฐัะตะปั1 โโโโ
โโโโโโโโโโโโโโโ  โ
                 โ  ะัะต ะฟะพะบัะฟะฐัะตะปะธ
โโโโโโโโโโโโโโโ  โ  ะบะพะฝะบััะธัััั ะทะฐ:
โ  ะะพะบัะฟะฐัะตะปั2 โโโโค  โข ะะฝะฒะตะฝัะฐัั ะฑััะณะตัะพะฒ
โโโโโโโโโโโโโโโ  โ  โข ะกัะพะปะธะบะธ
      ...        โ
โโโโโโโโโโโโโโโ  โ
โ  ะะพะบัะฟะฐัะตะปัN โโโโ
โโโโโโโโโโโโโโโ
       โ
       โ tryBuyBurger() / reserveTable()
       โ
โโโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโ
โ BurgerInventory  โ     โTableManager  โ
โ   (ะัััะตะบั)      โ     โ(ะัััะตะบั +    โ
โ                  โ     โ Condition    โ
โ  stock_[3]       โ     โ  Variable)   โ
โโโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโ
       โ                         โ
       โ notifyOutOfStock()      โ
       โ                         โ
โโโโโโโโโโโโโโโโโโโโ            โ
โ    Manager       โ            โ
โ  (Condition      โ            โ
โ   Variable)      โ            โ
โ                  โ            โ
โ  restock() โโโโโโโผโโโโโโโโโโโโโ
โโโโโโโโโโโโโโโโโโโโ
```

## ๐ก๏ธ ะะพัะพะบะพะฑะตะทะพะฟะฐัะฝะพััั

### 1. ะะฐัะธัะฐ ะธะฝะฒะตะฝัะฐัั ะฑััะณะตัะพะฒ (BurgerInventory)

**ะัะพะฑะปะตะผะฐ:** ะะตัะบะพะปัะบะพ ะฟะพะบัะฟะฐัะตะปะตะน ะผะพะณัั ะพะดะฝะพะฒัะตะผะตะฝะฝะพ ะฟััะฐัััั ะบัะฟะธัั ะฑััะณะตั ะพะดะฝะพะณะพ ัะธะฟะฐ.

**ะะตัะตะฝะธะต:** `std::mutex mutex_`

```cpp
bool tryBuyBurger(int burgerType) {
    std::lock_guard<std::mutex> lock(mutex_);  // โ๏ธ ะะะะะะะะะะ
    if (stock_[burgerType] > 0) {
        --stock_[burgerType];  // โ ะะตะทะพะฟะฐัะฝะพ: ัะพะปัะบะพ ะพะดะธะฝ ะฟะพัะพะบ ะทะดะตัั
        return true;
    }
    return false;
}  // โ๏ธ ะะะขะะะะขะะงะะกะะะฏ ะะะะะะะะะะะะะ (RAII)
```

**ะงัะพ ะทะฐัะธัะตะฝะพ:**
- ะงัะตะฝะธะต/ะทะฐะฟะธัั `stock_[3]` - ะผะฐััะธะฒะฐ ะธะฝะฒะตะฝัะฐัั
- ะัะพะฒะตัะบะฐ ะฝะฐะปะธัะธั ะธ ัะผะตะฝััะตะฝะธะต ััะตััะธะบะฐ - ะฐัะพะผะฐัะฝะฐั ะพะฟะตัะฐัะธั
- Callback ัััะฐะฝะพะฒะบะฐ - ะทะฐัะธัะตะฝะฐ ะผัััะตะบัะพะผ

**ะะตะท ะผัััะตะบัะฐ ะฑัะปะพ ะฑั:**
```cpp
// โ ะะะะะะะะะฌะะ (race condition):
if (stock_[burgerType] > 0) {  // ะะพัะพะบ 1: ะฟัะพะฒะตััะตั, ะตััั 1 ะฑััะณะตั
    // ะะพัะพะบ 2: ัะพะถะต ะฟัะพะฒะตััะตั, ะฒะธะดะธั 1 ะฑััะณะตั
    --stock_[burgerType];       // ะะพัะพะบ 1: ัะผะตะฝััะฐะตั ะดะพ 0
    --stock_[burgerType];       // ะะพัะพะบ 2: ัะผะตะฝััะฐะตั ะดะพ -1 โ
}
```

### 2. ะะฐัะธัะฐ ััะพะปะธะบะพะฒ (TableManager)

**ะัะพะฑะปะตะผะฐ:** 
- ะะตัะบะพะปัะบะพ ะฟะพะบัะฟะฐัะตะปะตะน ะผะพะณัั ะพะดะฝะพะฒัะตะผะตะฝะฝะพ ะฟัะพะฒะตัััั ะดะพัััะฟะฝะพััั ััะพะปะธะบะพะฒ
- ะัะถะฝะพ ะฑะปะพะบะธัะพะฒะฐัั ะฟะพะบัะฟะฐัะตะปะตะน, ะตัะปะธ ะฒัะต ััะพะปะธะบะธ ะทะฐะฝััั

**ะะตัะตะฝะธะต:** `std::mutex mutex_` + `std::condition_variable tableAvailable_`

```cpp
void reserveTable() {
    std::unique_lock<std::mutex> lock(mutex_);  // โ๏ธ ะะะะะะะะะะ
    
    // โ๏ธ ะฃะกะะะะะะฏ ะะะะะะะะะะฏ: ะฑะปะพะบะธััะตั ะฟะพัะพะบ, ะฟะพะบะฐ ััะปะพะฒะธะต ะฝะต ะฒัะฟะพะปะฝะธััั
    tableAvailable_.wait(lock, [this] { 
        return availableTables_ > 0;  // ะะดะตั ะฟะพะบะฐ ะตััั ัะฒะพะฑะพะดะฝัะต ััะพะปะธะบะธ
    });
    
    --availableTables_;  // โ ะะตะทะพะฟะฐัะฝะพ: ัะพะปัะบะพ ะพะดะธะฝ ะฟะพัะพะบ ะทะดะตัั
}  // โ๏ธ ะะะขะะะะขะะงะะกะะะฏ ะะะะะะะะะะะะะ
```

**ะงัะพ ะทะฐัะธัะตะฝะพ:**
- ะงัะตะฝะธะต/ะทะฐะฟะธัั `availableTables_` - ััะตััะธะบ ัะฒะพะฑะพะดะฝัั ััะพะปะธะบะพะฒ
- ะะปะพะบะธัะพะฒะบะฐ ะฟะพะบัะฟะฐัะตะปะตะน ะฟัะธ ะพััััััะฒะธะธ ััะพะปะธะบะพะฒ
- ะัะพะฑัะถะดะตะฝะธะต ะฟะพะบัะฟะฐัะตะปะตะน ะฟัะธ ะพัะฒะพะฑะพะถะดะตะฝะธะธ ััะพะปะธะบะฐ

**ะะฐะบ ัะฐะฑะพัะฐะตั condition variable:**
```cpp
// ะะพะบัะฟะฐัะตะปั 1: ะฒัะต ััะพะปะธะบะธ ะทะฐะฝััั
reserveTable() โ wait() โ ะะะะะะะฃะะขะกะฏ (ะฟะพัะพะบ ะทะฐััะฟะฐะตั)

// ะะพะบัะฟะฐัะตะปั 2: ะพัะฒะพะฑะพะถะดะฐะตั ััะพะปะธะบ
releaseTable() โ ++availableTables_ โ notify_one() โ ะะะะะฃะะะะะข ะฟะพะบัะฟะฐัะตะปั 1

// ะะพะบัะฟะฐัะตะปั 1: ะฟัะพััะฟะฐะตััั, ะฟัะพะฒะตััะตั ััะปะพะฒะธะต, ะทะฐะฝะธะผะฐะตั ััะพะปะธะบ
```

**ะะตะท condition variable ะฑัะปะพ ะฑั:**
```cpp
// โ ะะะะะะะะะฌะะ (busy waiting):
while (availableTables_ == 0) {
    // ะะพััะพัะฝะฝะพ ะฟัะพะฒะตััะตั ะฒ ัะธะบะปะต - ััะฐัะธั CPU
    std::this_thread::sleep_for(1ms);
}
```

### 3. ะะฐัะธัะฐ ัะพััะพัะฝะธั ะผะตะฝะตะดะถะตัะฐ (Manager)

**ะัะพะฑะปะตะผะฐ:**
- ะะตัะบะพะปัะบะพ ะฟะพะบัะฟะฐัะตะปะตะน ะผะพะณัั ะพะดะฝะพะฒัะตะผะตะฝะฝะพ ะฒัะทัะฒะฐัั ะผะตะฝะตะดะถะตัะฐ
- ะะตะฝะตะดะถะตั ะดะพะปะถะตะฝ ะพะฑัะฐะฑะฐััะฒะฐัั ะทะฐะฟัะพัั ะฟะพ ะพะดะฝะพะผั
- ะะตะฝะตะดะถะตั ะดะพะปะถะตะฝ ะถะดะฐัั ะทะฐะฟัะพัะพะฒ, ะฝะต ััะฐัั CPU

**ะะตัะตะฝะธะต:** `std::mutex mutex_` + `std::condition_variable restockRequest_`

```cpp
void callForRestock(int burgerType) {
    std::lock_guard<std::mutex> lock(mutex_);  // โ๏ธ ะะะะะะะะะะ
    pendingRestockType_ = burgerType;
    hasPendingRequest_ = true;
    restockRequest_.notify_one();  // โ๏ธ ะะะะะฃะะะะะข ะผะตะฝะตะดะถะตัะฐ
}

void managerLoop() {
    while (running_) {
        std::unique_lock<std::mutex> lock(mutex_);
        
        // โ๏ธ ะะะะะะะฃะะขะกะฏ, ะฟะพะบะฐ ะฝะตั ะทะฐะฟัะพัะพะฒ
        restockRequest_.wait(lock, [this] { 
            return !running_ || hasPendingRequest_; 
        });
        
        if (hasPendingRequest_) {
            int type = pendingRestockType_;
            hasPendingRequest_ = false;
            lock.unlock();
            
            inventory_.restock(type, quantity);  // โ ะะตะทะพะฟะฐัะฝะพ
        }
    }
}
```

**ะงัะพ ะทะฐัะธัะตะฝะพ:**
- `pendingRestockType_` ะธ `hasPendingRequest_` - ัะพััะพัะฝะธะต ะทะฐะฟัะพัะฐ
- ะัะพะผะฐัะฝะพััั ัััะฐะฝะพะฒะบะธ ัะปะฐะณะฐ ะธ ะฟัะพะฑัะถะดะตะฝะธั
- ะะฐััะธะฒะฝะพะต ะพะถะธะดะฐะฝะธะต (ะฝะต ััะฐัะธั CPU)

### 4. ะัะพะผะฐัะฝัะต ัะปะฐะณะธ

**ะัะฟะพะปัะทัะตััั:** `std::atomic<bool> running_`

```cpp
std::atomic<bool> running_;  // โ ะะตะท ะผัััะตะบัะฐ, ะฝะพ ะฟะพัะพะบะพะฑะตะทะพะฟะฐัะฝะพ

// ะ ะพะดะฝะพะผ ะฟะพัะพะบะต:
running_ = false;  // โ ะัะพะผะฐัะฝะฐั ะพะฟะตัะฐัะธั

// ะ ะดััะณะพะผ ะฟะพัะพะบะต:
while (running_) {  // โ ะัะพะผะฐัะฝะฐั ะฟัะพะฒะตัะบะฐ
    // ...
}
```

**ะะพัะตะผั atomic, ะฐ ะฝะต mutex:**
- ะัะพััะฐั ะพะฟะตัะฐัะธั (ััะตะฝะธะต/ะทะฐะฟะธัั bool)
- ะะต ะฝัะถะฝะฐ ะฑะปะพะบะธัะพะฒะบะฐ
- ะััััะตะต ัะตะผ ะผัััะตะบั ะดะปั ะฟัะพัััั ะพะฟะตัะฐัะธะน

## ๐ ะกัะตะผะฐ ัะธะฝััะพะฝะธะทะฐัะธะธ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ะะะขะะะะะะฏ ะะะะะะะกะะะกะขะฌ                โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

BurgerInventory:
  โโโโโโโโโโโโโโโ
  โ   mutex_    โ โ ะะฐัะธัะฐะตั stock_[3] ะธ ะพะฟะตัะฐัะธะธ
  โโโโโโโโโโโโโโโ

TableManager:
  โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ
  โ   mutex_    โ +  โ condition_variableโ โ ะะปะพะบะธััะตั/ะฟัะพะฑัะถะดะฐะตั ะฟะพะบัะฟะฐัะตะปะตะน
  โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ

Manager:
  โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ
  โ   mutex_    โ +  โ condition_variableโ โ ะะถะธะดะฐะตั ะทะฐะฟัะพัั
  โโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโ

Customer:
  โโโโโโโโโโโโโโโ
  โatomic<bool> โ โ ะคะปะฐะณ ะพััะฐะฝะพะฒะบะธ (ะฑะตะท ะผัััะตะบัะฐ)
  โโโโโโโโโโโโโโโ
```

## โ๏ธ ะัะธัะธัะตัะบะธะต ะผะพะผะตะฝัั ะฟะพัะพะบะพะฑะตะทะพะฟะฐัะฝะพััะธ

### 1. ะะฒะพะนะฝะฐั ะฟัะพะฒะตัะบะฐ ะธะฝะฒะตะฝัะฐัั
```cpp
// โ ะะะะะะะฌะะ:
std::lock_guard<std::mutex> lock(mutex_);
if (stock_[type] > 0) {  // ะัะพะฒะตัะบะฐ
    --stock_[type];      // ะะตะนััะฒะธะต
}
// ะะฑะฐ ะดะตะนััะฒะธั ะฐัะพะผะฐัะฝั ะฟะพะด ะพะดะฝะธะผ ะผัััะตะบัะพะผ

// โ ะะะะะะะะะฌะะ ะฑัะปะพ ะฑั:
if (getStock(type) > 0) {  // ะัะพะฒะตัะบะฐ (ะผัััะตะบั ะฒะทัั ะธ ะพัะฒะพะฑะพะถะดะตะฝ)
    // ะััะณะพะน ะฟะพัะพะบ ะผะพะถะตั ะบัะฟะธัั ะทะดะตัั!
    tryBuyBurger(type);    // ะะตะนััะฒะธะต (ะผัััะตะบั ะฒะทัั ัะฝะพะฒะฐ)
}
```

### 2. ะฃัะปะพะฒะฝะฐั ะฟะตัะตะผะตะฝะฝะฐั ั ะฟัะตะดะธะบะฐัะพะผ
```cpp
// โ ะะะะะะะฌะะ (ะทะฐัะธัะฐ ะพั spurious wakeup):
tableAvailable_.wait(lock, [this] { 
    return availableTables_ > 0; 
});

// โ ะะะะะะะะะฌะะ ะฑัะปะพ ะฑั:
while (availableTables_ == 0) {
    tableAvailable_.wait(lock);  // ะะพะถะตั ะฟัะพัะฝััััั ะฑะตะท ะฟัะธัะธะฝั!
}
```

### 3. RAII ะดะปั ะผัััะตะบัะพะฒ
```cpp
// โ ะะะะะะะฌะะ (ะฐะฒัะพะผะฐัะธัะตัะบะฐั ัะฐะทะฑะปะพะบะธัะพะฒะบะฐ):
{
    std::lock_guard<std::mutex> lock(mutex_);
    // ะพะฟะตัะฐัะธะธ
}  // ะัััะตะบั ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะฐะทะฑะปะพะบะธััะตััั ะฟัะธ ะฒััะพะดะต

// โ ะะะะะะะะะฌะะ ะฑัะปะพ ะฑั:
mutex_.lock();
// ะพะฟะตัะฐัะธะธ
mutex_.unlock();  // ะัะปะธ ะธัะบะปััะตะฝะธะต - ะผัััะตะบั ะฝะต ัะฐะทะฑะปะพะบะธััะตััั!
```

## ๐ฏ ะัะพะณะพะฒะฐั ะณะฐัะฐะฝัะธั ะฟะพัะพะบะพะฑะตะทะพะฟะฐัะฝะพััะธ

โ **ะัะต ะพะฑัะธะต ะดะฐะฝะฝัะต ะทะฐัะธัะตะฝั:**
- ะะฝะฒะตะฝัะฐัั โ `std::mutex`
- ะกัะพะปะธะบะธ โ `std::mutex` + `std::condition_variable`
- ะกะพััะพัะฝะธะต ะผะตะฝะตะดะถะตัะฐ โ `std::mutex` + `std::condition_variable`
- ะคะปะฐะณะธ ะพััะฐะฝะพะฒะบะธ โ `std::atomic`

โ **ะะตั race conditions:**
- ะัะต ะพะฟะตัะฐัะธะธ ััะตะฝะธั/ะทะฐะฟะธัะธ ะฟะพะด ะผัััะตะบัะฐะผะธ
- ะัะพะฒะตัะบะฐ ะธ ะดะตะนััะฒะธะต ะฐัะพะผะฐัะฝั

โ **ะะตั deadlock:**
- ะัััะตะบัั ะฒัะตะณะดะฐ ะฑะตััััั ะฒ ะพะดะฝะพะผ ะฟะพััะดะบะต
- ะัะฟะพะปัะทัะตััั RAII ะดะปั ะฐะฒัะพะผะฐัะธัะตัะบะพะน ัะฐะทะฑะปะพะบะธัะพะฒะบะธ

โ **ะญััะตะบัะธะฒะฝะพะต ะธัะฟะพะปัะทะพะฒะฐะฝะธะต ัะตััััะพะฒ:**
- ะะพัะพะบะธ ะฑะปะพะบะธัััััั ัะตัะตะท condition variables (ะฝะต busy waiting)
- ะะธะฝะธะผะฐะปัะฝะพะต ะฒัะตะผั ัะดะตัะถะฐะฝะธั ะผัััะตะบัะพะฒ

